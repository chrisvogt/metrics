<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chris Vogt - Personal Metrics API</title>
  <style>
    body {
      font-family: 'Iowan Old Style', 'Apple Garamond', Georgia, Baskerville, 'Times New Roman', 'Droid Serif', Times, 'Source Serif Pro', serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';
      margin: 0;
      padding: 0;
      line-height: 1.6;
      color: #fff;
      background: #1e1e2f;
      min-height: 100vh;
    }

    .page-container {
      max-width: 100%;
      margin: 0 auto;
      padding: 1.5rem;
    }

    @media (min-width: 768px) {
      .page-container {
        max-width: 100%;
        padding: 2rem;
      }
    }

    @media (min-width: 1024px) {
      .page-container {
        max-width: 1200px;
        padding: 2rem 3rem;
      }
    }

    @media (min-width: 1280px) {
      .page-container {
        max-width: 1400px;
        padding: 2rem 4rem;
      }
    }

    .content-container {
      background: rgba(1, 1, 1, 0.25);
      border-radius: 16px;
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
      border: 1px solid rgba(255, 255, 255, 0.08);
      overflow: hidden;
      margin: 1.5rem 0;
    }

    .content-container + .content-container {
      margin-top: 2rem;
    }

    .api-section-container {
      margin-top: 3rem;
    }

    .futuristic-header {
      position: relative;
      text-align: center;
      padding: 3rem 2rem 2.5rem;
      background: linear-gradient(135deg, #422EA3 0%, #711E9B 25%, #4A148C 50%, #311B92 75%, #1A237E 100%);
      color: white;
      border-radius: 24px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
      overflow: visible;
      margin: 0 0 3rem 0;
      min-height: 180px;
    }

    @media (min-width: 768px) {
      .futuristic-header {
        margin: 0 0 3rem 0;
      }
    }

    @media (min-width: 1024px) {
      .futuristic-header {
        margin: 0 0 3rem 0;
      }
    }

    @media (min-width: 1280px) {
      .futuristic-header {
        margin: 0 0 3rem 0;
      }
    }

    .cyber-grid {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: 
        linear-gradient(rgba(255,255,255,0.1) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255,255,255,0.1) 1px, transparent 1px);
      background-size: 20px 20px;
      animation: gridMove 60s linear infinite;
      opacity: 0.2;
    }

    .pulse-rings {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      pointer-events: none;
    }

    .pulse-rings .ring {
      position: absolute;
      border: 2px solid rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      animation: pulse 8s ease-out infinite;
    }

    .pulse-rings .ring-1 {
      width: 200px;
      height: 200px;
      animation-delay: 0s;
    }

    .pulse-rings .ring-2 {
      width: 300px;
      height: 300px;
      animation-delay: 1s;
    }

    .pulse-rings .ring-3 {
      width: 400px;
      height: 400px;
      animation-delay: 2s;
    }

    .metrics-text {
      position: relative;
      z-index: 10;
      font-size: 3.5rem;
      font-family: -apple-system, BlinkMacSystemFont, 'avenir next', avenir, 'helvetica neue', helvetica, Ubuntu, roboto, noto, 'segoe ui', arial, sans-serif;
      font-weight: 800;
      letter-spacing: -0.03em;
      margin-bottom: 1.5rem;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 0.08em;
      text-shadow: 0 0 40px rgba(255, 255, 255, 0.6);
    }

    .metrics-text .letter {
      position: relative;
      display: inline-block;
      opacity: 0;
      transform: translateY(30px) scale(0.8);
      animation: letterEntrance 2s ease-out forwards;
      transition: all 0.3s ease;
    }

    .metrics-text .letter:hover {
      transform: translateY(-5px) scale(1.1);
      text-shadow: 0 0 50px rgba(255, 255, 255, 0.8);
    }

    .metrics-text .letter:nth-child(1) { animation-delay: 0.1s; }
    .metrics-text .letter:nth-child(2) { animation-delay: 0.2s; }
    .metrics-text .letter:nth-child(3) { animation-delay: 0.3s; }
    .metrics-text .letter:nth-child(4) { animation-delay: 0.4s; }
    .metrics-text .letter:nth-child(5) { animation-delay: 0.5s; }
    .metrics-text .letter:nth-child(6) { animation-delay: 0.6s; }
    .metrics-text .letter:nth-child(7) { animation-delay: 0.7s; }
    .metrics-text .space { width: 0.3em; }

    .subtitle {
      position: relative;
      z-index: 10;
      font-size: 1.1rem;
      font-family: -apple-system, BlinkMacSystemFont, 'avenir next', avenir, 'helvetica neue', helvetica, Ubuntu, roboto, noto, 'segoe ui', arial, sans-serif;
      opacity: 0.85;
      margin-bottom: 0;
      display: flex;
      justify-content: center;
      gap: 1.5rem;
      flex-wrap: wrap;
      font-weight: 500;
      letter-spacing: 0.02em;
    }

    .subtitle-word {
      opacity: 0;
      animation: subtitleEntrance 0.8s ease-out forwards;
      animation-delay: 1.5s;
    }

    .subtitle-word:nth-child(2) { animation-delay: 1.7s; }
    .subtitle-word:nth-child(3) { animation-delay: 1.9s; }

    .data-streams {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }

    .data-streams .stream {
      position: absolute;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
      height: 2px;
      width: 100px;
      animation: dataFlow 12s linear infinite;
    }

    .data-streams .stream-1 {
      top: 20%;
      left: -100px;
      animation-delay: 0s;
    }

    .data-streams .stream-2 {
      top: 60%;
      left: -100px;
      animation-delay: 2s;
    }

    .data-streams .stream-3 {
      top: 80%;
      left: -100px;
      animation-delay: 4s;
    }

    .particle-field {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }

    .particle-field .particle {
      position: absolute;
      width: 4px;
      height: 4px;
      background: rgba(255, 255, 255, 0.6);
      border-radius: 50%;
      animation: particleFloat 20s infinite ease-in-out;
    }

    .particle-field .particle:nth-child(1) { top: 10%; left: 10%; animation-delay: 0s; }
    .particle-field .particle:nth-child(2) { top: 20%; right: 15%; animation-delay: 1s; }
    .particle-field .particle:nth-child(3) { top: 70%; left: 20%; animation-delay: 2s; }
    .particle-field .particle:nth-child(4) { top: 80%; right: 25%; animation-delay: 3s; }
    .particle-field .particle:nth-child(5) { top: 30%; left: 60%; animation-delay: 4s; }
    .particle-field .particle:nth-child(6) { top: 50%; right: 60%; animation-delay: 5s; }
    .particle-field .particle:nth-child(7) { top: 90%; left: 70%; animation-delay: 6s; }
    .particle-field .particle:nth-child(8) { top: 15%; right: 80%; animation-delay: 7s; }

    @keyframes gridMove {
      0% { transform: translate(0, 0); }
      100% { transform: translate(20px, 20px); }
    }

    @keyframes pulse {
      0% {
        transform: translate(-50%, -50%) scale(0.8);
        opacity: 1;
      }
      100% {
        transform: translate(-50%, -50%) scale(1.2);
        opacity: 0;
      }
    }

    @keyframes letterEntrance {
      0% {
        opacity: 0;
        transform: translateY(30px) scale(0.8);
      }
      100% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    @keyframes subtitleEntrance {
      0% {
        opacity: 0;
        transform: translateY(20px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes dataFlow {
      0% { left: -100px; opacity: 0; }
      50% { opacity: 1; }
      100% { left: 100%; opacity: 0; }
    }

    @keyframes particleFloat {
      0%, 100% {
        transform: translateY(0) translateX(0) scale(1);
        opacity: 0.8;
      }
      25% {
        transform: translateY(-15px) translateX(10px) scale(1.2);
        opacity: 1;
      }
      50% {
        transform: translateY(-10px) translateX(-5px) scale(0.9);
        opacity: 0.6;
      }
      75% {
        transform: translateY(-20px) translateX(15px) scale(1.1);
        opacity: 1;
      }
    }

    /* Auth Section */
    .auth-section {
      padding: 2.5rem;
      background: rgba(1, 1, 1, 0.25);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-radius: 20px;
      margin: 2rem auto;
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
      max-width: 500px;
    }

    @media (min-width: 768px) {
      .auth-section {
        max-width: 550px;
      }
    }

    @media (min-width: 1024px) {
      .auth-section {
        max-width: 600px;
      }
    }

    .auth-tabs {
      display: flex;
      margin-bottom: 2.5rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      gap: 0.5rem;
    }

    .auth-tab {
      flex: 1;
      padding: 1rem 1.5rem;
      text-align: center;
      background: none;
      border: none;
      font-size: 0.95rem;
      font-weight: 600;
      color: rgba(255, 255, 255, 0.6);
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border-bottom: 2px solid transparent;
      border-radius: 8px 8px 0 0;
    }

    .auth-tab.active {
      color: #fff;
      border-bottom-color: #422EA3;
      background: rgba(66, 46, 163, 0.1);
    }

    .auth-tab:hover {
      color: #fff;
      background: rgba(255, 255, 255, 0.05);
    }

    .auth-content {
      display: none;
    }

    .auth-content.active {
      display: block;
    }

    /* Message handling */
    .message {
      padding: 1rem 1.25rem;
      border-radius: 12px;
      margin-bottom: 1.5rem;
      font-weight: 500;
      border: 1px solid transparent;
    }

    .message.error {
      background: rgba(220, 53, 69, 0.1);
      color: #ff6b6b;
      border-color: rgba(220, 53, 69, 0.2);
    }

    .message.success {
      background: rgba(40, 167, 69, 0.1);
      color: #51cf66;
      border-color: rgba(40, 167, 69, 0.2);
    }

    .message.info {
      background: rgba(66, 46, 163, 0.1);
      color: #a8a4ff;
      border-color: rgba(66, 46, 163, 0.2);
    }

    /* Loading States */
    .loading {
      opacity: 0.7;
      pointer-events: none;
    }

    .spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, .3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    /* Hidden */
    .hidden {
      display: none !important;
    }

    /* Form Styles */
    .form-group {
      margin-bottom: 2rem;
    }

    .form-label {
      display: block;
      margin-bottom: 0.75rem;
      font-weight: 600;
      color: rgba(255, 255, 255, 0.9);
      font-size: 0.95rem;
      letter-spacing: 0.02em;
    }

    .form-input {
      width: 100%;
      padding: 1rem 1.25rem;
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 12px;
      font-size: 1rem;
      font-family: -apple-system, BlinkMacSystemFont, 'avenir next', avenir, 'helvetica neue', helvetica, Ubuntu, roboto, noto, 'segoe ui', arial, sans-serif;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-sizing: border-box;
      background: rgba(255, 255, 255, 0.05);
      color: #fff;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .form-input:focus {
      outline: none;
      border-color: #422EA3;
      box-shadow: 0 0 0 4px rgba(66, 46, 163, 0.15);
      background: rgba(255, 255, 255, 0.08);
    }

    .form-input::placeholder {
      color: rgba(255, 255, 255, 0.4);
    }

    .form-button {
      width: 100%;
      padding: 1rem 1.5rem;
      border: none;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      margin-bottom: 1.5rem;
      position: relative;
      overflow: hidden;
    }

    .btn-primary {
      background: linear-gradient(135deg, #422EA3 0%, #711E9B 100%);
      color: white;
      border-radius: 12px;
      box-shadow: 0 4px 16px rgba(66, 46, 163, 0.3);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(66, 46, 163, 0.4);
    }

    .btn-primary:active {
      transform: translateY(0);
      box-shadow: 0 4px 16px rgba(66, 46, 163, 0.3);
    }

    .btn-secondary {
      background: #f8f9fa;
      color: #333;
      border: 2px solid #e1e5e9;
    }

    .btn-secondary:hover {
      background: #e9ecef;
      border-color: #667eea;
    }

    .btn-google {
      background: rgba(255, 255, 255, 0.95);
      color: #333;
      border: 1px solid rgba(255, 255, 255, 0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.75rem;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .btn-google:hover {
      background: rgba(255, 255, 255, 1);
      transform: translateY(-1px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
    }

    .google-icon {
      width: 20px;
      height: 20px;
    }

    /* Divider */
    .divider {
      text-align: center;
      margin: 2rem 0;
      position: relative;
    }

    .divider::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 0;
      right: 0;
      height: 1px;
      background: rgba(255, 255, 255, 0.15);
    }

    .divider span {
      background: rgba(1, 1, 1, 0.25);
      padding: 0 1.5rem;
      color: rgba(255, 255, 255, 0.6);
      font-size: 0.9rem;
      font-weight: 500;
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
    }

    /* User Info */
    .user-info {
      background: linear-gradient(135deg, #422EA3 0%, #711E9B 100%);
      color: white;
      padding: 2rem;
      border-radius: 16px;
      margin-bottom: 1.5rem;
      box-shadow: 0 8px 24px rgba(66, 46, 163, 0.3);
    }

    .user-info h3 {
      margin: 0 0 1.5rem 0;
      font-size: 1.4rem;
      font-weight: 700;
    }

    .user-detail {
      margin-bottom: 0.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .user-detail strong {
      min-width: 80px;
    }

    /* Error/Success Messages */
    .message {
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      font-weight: 500;
    }

    .message.error {
      background: #fee;
      color: #c53030;
      border: 1px solid #fed7d7;
    }

    .message.success {
      background: #f0fff4;
      color: #2f855a;
      border: 1px solid #c6f6d5;
    }

    /* Loading States */
    .loading {
      opacity: 0.7;
      pointer-events: none;
    }

    .spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, .3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    /* Hidden */
    .hidden {
      display: none;
    }

    /* API Section */
    .api-section {
      background: rgba(1, 1, 1, 0.25);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      padding: 2.5rem;
      border-radius: 20px;
      margin: 2rem 0;
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
    }

    .api-endpoint {
      background: rgba(30, 37, 48, 0.8);
      padding: 1.5rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      border-left: 4px solid #1E90FF;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      color: #fff;
    }

    .endpoint-url {
      font-family: monospace;
      background: #f8f9fa;
      padding: 0.5rem 1rem;
      border-radius: 6px;
      color: #495057;
      display: inline-block;
      margin: 0.5rem 0;
    }

    /* Futuristic Header Styles */
    .futuristic-header {
      position: relative;
      text-align: center;
      padding: 3rem 2rem 2rem;
      background: linear-gradient(135deg, #422EA3 0%, #711E9B 25%, #4A148C 50%, #311B92 75%, #1A237E 100%);
      color: white;
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      margin-bottom: 2rem;
    }

    .header-glow {
      position: absolute;
      top: -50px;
      left: -50px;
      width: 100px;
      height: 100px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      filter: blur(50px);
      animation: glow 5s infinite alternate;
    }

    .metrics-text {
      font-size: 3.5rem;
      font-weight: 900;
      letter-spacing: -0.05em;
      margin-bottom: 0.5rem;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 0.1em;
    }

    .metrics-text .letter {
      position: relative;
      display: inline-block;
      opacity: 0;
      transform: translateY(20px);
      animation: float 0.8s ease-out forwards;
    }

    .metrics-text .letter:nth-child(1) { animation-delay: 0.1s; }
    .metrics-text .letter:nth-child(2) { animation-delay: 0.2s; }
    .metrics-text .letter:nth-child(3) { animation-delay: 0.3s; }
    .metrics-text .letter:nth-child(4) { animation-delay: 0.4s; }
    .metrics-text .letter:nth-child(5) { animation-delay: 0.5s; }
    .metrics-text .letter:nth-child(6) { animation-delay: 0.6s; }
    .metrics-text .letter:nth-child(7) { animation-delay: 0.7s; }
    .metrics-text .space { width: 0.5em; }

    .subtitle {
      font-size: 1.2rem;
      opacity: 0.9;
      margin-bottom: 2rem;
    }

    .floating-elements {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }

    .floating-elements .element {
      position: absolute;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 50%;
      animation: float 8s infinite ease-in-out;
    }

    .floating-elements .element-1 {
      width: 50px;
      height: 50px;
      top: 10%;
      left: 10%;
      animation-delay: -2s;
    }
    .floating-elements .element-2 {
      width: 30px;
      height: 30px;
      bottom: 20%;
      right: 20%;
      animation-delay: -3s;
    }
    .floating-elements .element-3 {
      width: 70px;
      height: 70px;
      top: 70%;
      left: 30%;
      animation-delay: -1s;
    }
    .floating-elements .element-4 {
      width: 40px;
      height: 40px;
      bottom: 50%;
      right: 50%;
      animation-delay: -4s;
    }

    @keyframes glow {
      from {
        opacity: 0.5;
        transform: scale(0.9);
      }
      to {
        opacity: 0.8;
        transform: scale(1.1);
      }
    }

    @keyframes float {
      0% {
        transform: translateY(0) translateX(0) scale(1);
        opacity: 0.8;
      }
      50% {
        transform: translateY(-10px) translateX(10px) scale(1.05);
        opacity: 1;
      }
      100% {
        transform: translateY(0) translateX(0) scale(1);
        opacity: 0.8;
      }
    }
    /* API Testing Interface Styles */
    .api-section-container {
      background: rgba(1, 1, 1, 0.25);
      border-radius: 20px;
      padding: 2.5rem;
      margin: 2rem 0;
      border: 1px solid rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .api-section-container.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .api-section-container.hidden {
      display: none;
    }

    /* Dashboard Layout */
    .dashboard-container {
      display: flex;
      min-height: 100vh;
      background: linear-gradient(135deg, #1a1a3a 0%, #2d1b69 50%, #3d2b8a 100%);
    }

    /* Sidebar */
    .dashboard-sidebar {
      width: 280px;
      background: linear-gradient(180deg, #2d1b69 0%, #4a2b8a 50%, #6b46c1 100%);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-right: 1px solid rgba(255, 255, 255, 0.15);
      display: flex;
      flex-direction: column;
      position: fixed;
      height: 100vh;
      z-index: 1000;
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .dashboard-sidebar.collapsed {
      transform: translateX(-100%);
    }

    .sidebar-header {
      padding: 2rem 1.5rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
    }

    .logo {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .logo-text {
      font-size: 1.5rem;
      font-weight: 800;
      color: #fff;
      letter-spacing: 0.1em;
      background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .logo-subtitle {
      font-size: 0.8rem;
      color: rgba(255, 255, 255, 0.6);
      margin-top: 0.25rem;
      font-weight: 500;
    }

    .sidebar-nav {
      flex: 1;
      padding: 2rem 1rem;
    }

    .nav-section {
      margin-bottom: 2rem;
    }

    .nav-title {
      color: rgba(255, 255, 255, 0.5);
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      margin-bottom: 1rem;
      padding-left: 0.5rem;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1rem;
      color: rgba(255, 255, 255, 0.8);
      cursor: pointer;
      border-radius: 8px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      margin-bottom: 0.5rem;
    }

    .nav-item:hover {
      background: rgba(255, 255, 255, 0.05);
      color: #fff;
      transform: translateX(4px);
    }

    .nav-item.active {
      background: rgba(139, 92, 246, 0.2);
      color: #fff;
      border-left: 3px solid #8b5cf6;
    }

    .nav-icon {
      font-size: 1.2rem;
    }

    .nav-text {
      font-weight: 500;
      font-size: 0.95rem;
    }

    .sidebar-footer {
      padding: 1.5rem;
      border-top: 1px solid rgba(255, 255, 255, 0.08);
    }

    .user-profile {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .user-avatar {
      width: 40px;
      height: 40px;
      background: rgba(66, 46, 163, 0.2);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
    }

    .user-details {
      flex: 1;
    }

    .user-name {
      color: #fff;
      font-weight: 600;
      font-size: 0.9rem;
      margin-bottom: 0.5rem;
    }

    .logout-btn {
      background: none;
      border: none;
      color: rgba(255, 255, 255, 0.6);
      font-size: 0.8rem;
      cursor: pointer;
      padding: 0;
      text-decoration: underline;
    }

    .logout-btn:hover {
      color: #fff;
    }

    /* Main Content */
    .dashboard-main {
      flex: 1;
      margin-left: 280px;
      min-height: 100vh;
      background: linear-gradient(135deg, #2d1b69 0%, #3d2b8a 50%, #4a2b8a 100%);
    }

    .dashboard-header {
      background: rgba(45, 27, 105, 0.4);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.15);
      padding: 1rem 2rem;
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .page-title {
      color: #fff;
      font-size: 1.5rem;
      font-weight: 700;
      margin: 0;
    }

    .menu-toggle {
      display: none;
      background: none;
      border: none;
      color: #fff;
      font-size: 1.5rem;
      cursor: pointer;
      padding: 0.5rem;
      border-radius: 6px;
      transition: background 0.3s ease;
    }

    .menu-toggle:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .dashboard-content {
      padding: 2rem;
    }

    .content-section {
      background: rgba(45, 27, 105, 0.3);
      border-radius: 20px;
      padding: 2.5rem;
      margin-bottom: 2rem;
      border: 1px solid rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      box-shadow: 0 8px 32px rgba(45, 27, 105, 0.4);
    }

    .section-header {
      text-align: center;
      margin-bottom: 2.5rem;
    }

    .section-header h2 {
      color: #fff;
      font-size: 2.25rem;
      font-weight: 800;
      margin-bottom: 0.5rem;
      background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .section-header p {
      color: rgba(255, 255, 255, 0.7);
      font-size: 1.1rem;
      margin: 0;
    }

    .auth-container {
      max-width: 500px;
      margin: 0 auto;
    }

    .google-login-content {
      text-align: center;
      padding: 2rem 0;
    }

    .google-login-content p {
      margin-bottom: 2rem;
      color: rgba(255, 255, 255, 0.7);
    }

    /* Responsive Design */
    @media (max-width: 1024px) {
      .dashboard-sidebar {
        transform: translateX(-100%);
      }
      
      .dashboard-sidebar.mobile-open {
        transform: translateX(0);
      }
      
      .dashboard-main {
        margin-left: 0;
      }
      
      .menu-toggle {
        display: block;
      }
    }

    @media (max-width: 768px) {
      .dashboard-content {
        padding: 1rem;
      }
      
      .content-section {
        padding: 1.5rem;
      }
      
      .section-header h2 {
        font-size: 1.75rem;
      }
    }



    /* API Endpoints Container */
    .api-endpoints-container {
      background: rgba(107, 70, 193, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 2rem;
      margin-bottom: 2rem;
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      scroll-margin-top: 2rem;
    }

    .api-section-container h2 {
      color: #fff;
      font-size: 2.25rem;
      margin-bottom: 2.5rem;
      text-align: center;
      background: linear-gradient(135deg, #422EA3 0%, #711E9B 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-weight: 800;
      letter-spacing: -0.02em;
    }

    .auth-status {
      background: rgba(139, 92, 246, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 2rem;
      margin-bottom: 2rem;
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
    }

    .auth-status h3 {
      color: #fff;
      margin-bottom: 1rem;
      font-size: 1.25rem;
    }

    .auth-status-content {
      display: flex;
      align-items: center;
      gap: 15px;
      color: #fff;
    }

    .api-endpoints-container h3 {
      color: #fff;
      margin-bottom: 1.5rem;
      font-size: 1.25rem;
    }

    .endpoint-group {
      margin-bottom: 2.5rem;
      scroll-margin-top: 2rem;
    }

    .endpoint-group h4 {
      color: #fff;
      border-bottom: 2px solid #8b5cf6;
      padding-bottom: 0.75rem;
      margin-bottom: 1.5rem;
      font-size: 1.2rem;
      font-weight: 700;
      letter-spacing: 0.02em;
    }

    /* Highlight active section when navigating */
    .endpoint-group:target {
      animation: highlightSection 0.5s ease-out;
    }

    .endpoint-group:target h4 {
      color: #8b5cf6;
      text-shadow: 0 0 10px rgba(139, 92, 246, 0.5);
    }

    @keyframes highlightSection {
      0% {
        background: rgba(139, 92, 246, 0.1);
        transform: scale(1.02);
        box-shadow: 0 0 20px rgba(139, 92, 246, 0.3);
      }
      100% {
        background: transparent;
        transform: scale(1);
        box-shadow: none;
      }
    }

    .endpoint-item {
      background: rgba(107, 70, 193, 0.1);
      border: 1px solid rgba(107, 70, 193, 0.3);
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 1.25rem;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .endpoint-item:hover {
      background: rgba(107, 70, 193, 0.2);
      border-color: rgba(107, 70, 193, 0.5);
      transform: translateY(-3px);
      box-shadow: 0 8px 24px rgba(107, 70, 193, 0.3);
    }

    .endpoint-header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 10px;
    }

    .method {
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 11px;
      font-weight: bold;
      text-transform: uppercase;
      color: white;
      min-width: 60px;
      text-align: center;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .method.get {
      background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
    }

    .method.post {
      background: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%);
    }

    .method.put {
      background: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%);
      color: #212529;
    }

    .method.delete {
      background: linear-gradient(135deg, #ef4444 0%, #f87171 100%);
    }

    .endpoint-url {
      font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', 'Courier New', monospace;
      background: rgba(139, 92, 246, 0.15);
      color: #fff;
      padding: 10px 14px;
      border-radius: 8px;
      font-size: 13px;
      flex: 1;
      border: 1px solid rgba(139, 92, 246, 0.3);
      letter-spacing: 0.02em;
    }

    .endpoint-item p {
      color: rgba(255, 255, 255, 0.8);
      margin: 0.5rem 0;
    }

    /* Inline Endpoint Results */
    .endpoint-result {
      margin-top: 1rem;
      padding: 1rem;
      border-radius: 8px;
      border: 1px solid rgba(139, 92, 246, 0.2);
      background: rgba(139, 92, 246, 0.1);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .endpoint-result.hidden {
      display: none;
    }

    .result-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.75rem;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .result-status {
      font-weight: 600;
      font-size: 0.9rem;
    }

    .result-status.success {
      color: #10b981;
    }

    .result-status.error {
      color: #ef4444;
    }

    .result-status.info {
      color: #3b82f6;
    }

    .result-time {
      color: rgba(255, 255, 255, 0.6);
      font-size: 0.8rem;
      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    }

    .result-content {
      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
      font-size: 0.85rem;
      line-height: 1.5;
      color: rgba(255, 255, 255, 0.9);
      background: rgba(0, 0, 0, 0.4);
      padding: 1rem;
      border-radius: 6px;
      border: 1px solid rgba(255, 255, 255, 0.05);
      max-height: 300px;
      overflow-y: auto;
      white-space: pre-wrap;
      word-break: break-word;
    }

    .endpoint-params {
      margin-top: 1rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .endpoint-params label {
      font-weight: 500;
      color: #fff;
      min-width: 80px;
    }

    .form-control {
      padding: 10px 14px;
      border: 1px solid rgba(139, 92, 246, 0.3);
      border-radius: 8px;
      font-size: 14px;
      min-width: 150px;
      background: rgba(139, 92, 246, 0.1);
      color: #fff;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .form-control:focus {
      outline: none;
      border-color: #8b5cf6;
      box-shadow: 0 0 0 4px rgba(139, 92, 246, 0.2);
      background: rgba(139, 92, 246, 0.15);
    }

    .btn-sm {
      padding: 8px 16px;
      font-size: 12px;
      font-weight: 600;
      background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 2px 8px rgba(139, 92, 246, 0.3);
    }

    .btn-sm:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(139, 92, 246, 0.4);
    }

    /* Button Loading States */
    .btn-loading {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .btn .spinner {
      width: 14px;
      height: 14px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
    }

    /* Hidden class for loading states */
    .hidden {
      display: none !important;
    }

    /* Ensure button loading states work properly */
    .btn .btn-loading.hidden {
      display: none !important;
    }

    .btn .btn-text.hidden {
      display: none !important;
    }





    /* Button styles for the testing interface */
    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      text-decoration: none;
      display: inline-block;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .btn-primary {
      background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%);
      color: white;
      box-shadow: 0 4px 16px rgba(139, 92, 246, 0.3);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(139, 92, 246, 0.4);
    }

    .btn-secondary {
      background: rgba(255, 255, 255, 0.08);
      color: #fff;
      border: 1px solid rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.12);
      border-color: rgba(255, 255, 255, 0.25);
      transform: translateY(-1px);
    }

    .btn-success {
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      color: white;
      box-shadow: 0 4px 16px rgba(40, 167, 69, 0.3);
    }

    .btn-success:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(40, 167, 69, 0.4);
    }
  </style>
</head>

<body>
  <div class="dashboard-container">
    <!-- Sidebar Navigation -->
    <aside class="dashboard-sidebar" id="dashboardSidebar">
      <div class="sidebar-header">
        <div class="logo">
          <span class="logo-text">METRICS</span>
          <span class="logo-subtitle">API</span>
        </div>
      </div>
      
      <nav class="sidebar-nav">
        <div class="nav-section">
          <h3 class="nav-title">Authentication</h3>
          <div class="nav-item active" data-section="auth">
            <span class="nav-icon">🔐</span>
            <span class="nav-text">Sign In</span>
          </div>
        </div>
        
        <div class="nav-section" id="apiNavSection" style="display: none;">
          <h3 class="nav-title">API Testing</h3>
          <div class="nav-item" data-section="widget-data">
            <span class="nav-icon">🔌</span>
            <span class="nav-text">Widget Data</span>
          </div>
          <div class="nav-item" data-section="sync-data">
            <span class="nav-icon">📊</span>
            <span class="nav-text">Sync Data</span>
          </div>
        </div>
      </nav>
      
      <div class="sidebar-footer">
        <div class="user-profile" id="userProfile" style="display: none;">
          <div class="user-avatar">👤</div>
          <div class="user-details">
            <div class="user-name" id="sidebarUserEmail">User</div>
                            <button class="logout-btn" onclick="handleLogout(event)">Sign Out</button>
          </div>
        </div>
      </div>
    </aside>

    <!-- Main Content Area -->
    <main class="dashboard-main">
      <!-- Top Header -->
      <header class="dashboard-header">
        <div class="header-content">
          <h1 class="page-title">Metrics API Dashboard</h1>
          <div class="header-actions">
            <button class="menu-toggle" id="menuToggle" onclick="toggleSidebar()">
              <span class="menu-icon">☰</span>
            </button>
          </div>
        </div>
      </header>

      <!-- Content Sections -->
      <div class="dashboard-content">

        <!-- Authentication Section -->
        <section class="content-section" id="authSection">
          <div class="section-header">
            <h2>Authentication</h2>
            <p>Sign in to access the API testing interface</p>
          </div>
          
          <div class="auth-container">
            <div class="auth-tabs">
              <button class="auth-tab active" onclick="switchTab('email', event)">Email</button>
              <button class="auth-tab" onclick="switchTab('phone', event)">Phone</button>
              <button class="auth-tab" onclick="switchTab('google', event)">Google</button>
            </div>

            <!-- Email/Password Login -->
            <div id="emailTab" class="auth-content active">
              <form id="emailForm" onsubmit="handleEmailLogin(event)">
                <div class="form-group">
                  <label class="form-label" for="email">Email</label>
                  <input type="email" id="email" class="form-input" placeholder="your@email.com" required>
                </div>
                <div class="form-group">
                  <label class="form-label" for="password">Password</label>
                  <input type="password" id="password" class="form-input" placeholder="Enter your password" required>
                </div>
                <button type="submit" class="form-button btn-primary">
                  <span class="btn-text">Sign In</span>
                  <span class="btn-loading hidden"><span class="spinner"></span> Signing in...</span>
                </button>
              </form>

              <div class="divider">
                <span>or</span>
              </div>

              <button class="form-button btn-google" onclick="handleGoogleLogin()">
                <svg class="google-icon" viewBox="0 0 24 24">
                  <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" />
                  <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" />
                  <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" />
                  <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
                </svg>
                Continue with Google
              </button>
            </div>

            <!-- Phone Login -->
            <div id="phoneTab" class="auth-content">
              <form id="phoneForm" onsubmit="handlePhoneLogin(event)">
                <div class="form-group">
                  <label class="form-label" for="phone">Phone Number</label>
                  <input type="tel" id="phone" class="form-input" placeholder="+1 (555) 123-4567" required>
                </div>
                <div id="phoneCodeGroup" class="form-group hidden">
                  <label class="form-label" for="phoneCode">Verification Code</label>
                  <input type="text" id="phoneCode" class="form-input" placeholder="Enter 6-digit code" maxlength="6">
                </div>
                <button type="submit" class="form-button btn-primary">
                  <span class="btn-text">Send Code</span>
                  <span class="btn-loading hidden"><span class="spinner"></span> Sending...</span>
                </button>
              </form>

              <div class="divider">
                <span>or</span>
              </div>

              <button class="form-button btn-google" onclick="handleGoogleLogin()">
                <svg class="google-icon" viewBox="0 0 24 24">
                  <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" />
                  <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" />
                  <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" />
                  <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
                </svg>
                Continue with Google
              </button>
            </div>

            <!-- Google Login -->
            <div id="googleTab" class="auth-content">
              <div class="google-login-content">
                <p>Sign in with your Google account</p>
                <button class="form-button btn-google" onclick="handleGoogleLogin()">
                  <svg class="google-icon" viewBox="0 0 24 24">
                    <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" />
                    <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" />
                  </svg>
                  Continue with Google
                </button>
              </div>
            </div>

            <div id="messageContainer"></div>
          </div>
        </section>



        <!-- API Testing Section -->
        <section class="content-section hidden" id="apiTestingSection">
          <div class="section-header">
            <h2>API Testing Interface</h2>
            <p>Test your API endpoints and view results</p>
          </div>
          
          <!-- Authentication Status -->
          <div class="auth-status">
            <h3>Authentication Status</h3>
            <div id="authStatus" class="auth-status-content">
              <p>Not authenticated</p>
              <button id="getTokenBtn" class="btn btn-primary" onclick="getFreshToken()">Get Fresh ID Token</button>
            </div>
          </div>

          <!-- Widget Data Section -->
          <div class="api-endpoints-container" id="widget-data">
            <h3>Widget Data Endpoints (No Auth Required)</h3>
            
            <div class="endpoint-group">
              <h4>Get Widget Content</h4>
              <div class="endpoint-item">
                <div class="endpoint-header">
                  <span class="method get">GET</span>
                  <span class="endpoint-url">/api/widgets/{provider}</span>
                  <button class="btn btn-sm btn-secondary" onclick="testEndpoint('widgets', false)" data-endpoint="widgets">
                    <span class="btn-text">Test</span>
                    <span class="btn-loading hidden">
                      <span class="spinner"></span> Testing...
                    </span>
                  </button>
                </div>
                <p>Get widget content for various platforms</p>
                <div class="endpoint-params">
                  <label>Provider:</label>
                  <select id="widgetProvider" class="form-control">
                    <option value="spotify">spotify</option>
                    <option value="steam">steam</option>
                    <option value="goodreads">goodreads</option>
                    <option value="instagram">instagram</option>
                    <option value="discogs">discogs</option>
                    <option value="flickr">flickr</option>
                  </select>
                </div>
                <!-- Inline test result for this endpoint -->
                <div id="widgets-result" class="endpoint-result hidden">
                  <div class="result-header">
                    <span class="result-status"></span>
                    <span class="result-time"></span>
                  </div>
                  <div class="result-content"></div>
                </div>
              </div>
            </div>
          </div>

          <!-- Sync Data Section -->
          <div class="api-endpoints-container" id="sync-data">
            <h3>Sync Data Endpoints (Authentication Required)</h3>
            
            <div class="endpoint-group">
              <h4>Session Management</h4>
              <div class="endpoint-item">
                <div class="endpoint-header">
                  <span class="method post">POST</span>
                  <span class="endpoint-url">/api/auth/session</span>
                  <button class="btn btn-sm btn-secondary" onclick="testEndpoint('session', true)" data-endpoint="session">
                    <span class="btn-text">Test</span>
                    <span class="btn-loading hidden">
                      <span class="spinner"></span> Testing...
                    </span>
                  </button>
                </div>
                <p>Create session cookie from ID token</p>
                <!-- Inline test result for this endpoint -->
                <div id="session-result" class="endpoint-result hidden">
                  <div class="result-header">
                    <span class="result-status"></span>
                    <span class="result-time"></span>
                  </div>
                  <div class="result-content"></div>
                </div>
              </div>
            </div>
            
            <div class="endpoint-group">
              <h4>Data Synchronization</h4>
              <div class="endpoint-item">
                <div class="endpoint-header">
                  <span class="method get">GET</span>
                  <span class="endpoint-url">/api/widgets/sync/{provider}</span>
                  <button class="btn btn-sm btn-secondary" onclick="testEndpoint('sync', true)" data-endpoint="sync">
                    <span class="btn-text">Test</span>
                    <span class="btn-loading hidden">
                      <span class="spinner"></span> Testing...
                    </span>
                  </button>
                </div>
                <p>Trigger data sync for a specific provider</p>
                <div class="endpoint-params">
                  <label>Provider:</label>
                  <select id="syncProvider" class="form-control">
                    <option value="spotify">spotify</option>
                    <option value="steam">steam</option>
                    <option value="goodreads">goodreads</option>
                    <option value="instagram">instagram</option>
                    <option value="discogs">discogs</option>
                    <option value="flickr">flickr</option>
                  </select>
                </div>
                <!-- Inline test result for this endpoint -->
                <div id="sync-result" class="endpoint-result hidden">
                  <div class="result-header">
                    <span class="result-status"></span>
                    <span class="result-time"></span>
                  </div>
                  <div class="result-content"></div>
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>
    </main>
  </div>

  <!-- Firebase SDK -->
  <script type="module">
    // Import Firebase modules
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
    import {
      getAuth,
      signInWithPopup,
      signInWithEmailAndPassword,
      signInWithPhoneNumber,
      RecaptchaVerifier,
      GoogleAuthProvider,
      signOut,
      onAuthStateChanged,
      connectAuthEmulator
    } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

    // Import Firebase config and API client
    import { loadFirebaseConfig } from './firebase-config.js';
    import { ApiClient } from './api-client.js';

    // Initialize Firebase with dynamic config
    let app, auth, apiClient;

    async function initializeFirebase() {
      try {
        const firebaseConfig = await loadFirebaseConfig();
        app = initializeApp(firebaseConfig);
        auth = getAuth(app);

        // Connect to emulator in development
        if (window.location.hostname === 'metrics.dev-chrisvogt.me' ||
          window.location.hostname === 'localhost' ||
          window.location.hostname === '127.0.0.1') {
          connectAuthEmulator(auth, 'http://127.0.0.1:9099');
          console.log('Connected to Firebase Auth emulator');
        }

        // Initialize the rest of the app
        setupApp();
      } catch (error) {
        console.error('Failed to initialize Firebase:', error);
      }
    }

    function setupApp() {
      const provider = new GoogleAuthProvider();
      provider.setCustomParameters({
        hd: 'chrisvogt.me' // Restrict to your domain
      });

      // Initialize API client
      apiClient = new ApiClient();

      // Global variables
      let phoneVerifier = null;
      let phoneConfirmationResult = null;

      // Tab switching
      window.switchTab = function (tabName, event) {
        // Update tabs
        document.querySelectorAll('.auth-tab').forEach(tab => tab.classList.remove('active'));
        if (event && event.target) {
          event.target.classList.add('active');
        }

        // Update content
        document.querySelectorAll('.auth-content').forEach(content => content.classList.remove('active'));
        document.getElementById(tabName + 'Tab').classList.add('active');

        // Clear messages
        clearMessages();
      };

      // Message handling
      function showMessage(message, type = 'error') {
        const container = document.getElementById('messageContainer');
        container.innerHTML = `<div class="message ${type}">${message}</div>`;
      }

      function clearMessages() {
        document.getElementById('messageContainer').innerHTML = '';
      }

      // Loading states
      function setLoading(button, loading) {
        const btnText = button.querySelector('.btn-text');
        const btnLoading = button.querySelector('.btn-loading');

        if (loading) {
          btnText.classList.add('hidden');
          btnLoading.classList.remove('hidden');
          button.classList.add('loading');
        } else {
          btnText.classList.remove('hidden');
          btnLoading.classList.add('hidden');
          button.classList.remove('loading');
        }
      }

      // Email/Password Login
      window.handleEmailLogin = async function (event) {
        event.preventDefault();
        const form = event.target;
        const button = form.querySelector('button[type="submit"]');
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;

        setLoading(button, true);
        clearMessages();

        try {
          await signInWithEmailAndPassword(auth, email, password);
          showMessage('Successfully signed in!', 'success');
        } catch (error) {
          console.error('Email login error:', error);
          let message = 'Login failed. Please check your credentials.';

          switch (error.code) {
            case 'auth/user-not-found':
              message = 'No account found with this email address.';
              break;
            case 'auth/wrong-password':
              message = 'Incorrect password.';
              break;
            case 'auth/invalid-email':
              message = 'Please enter a valid email address.';
              break;
            case 'auth/too-many-requests':
              message = 'Too many failed attempts. Please try again later.';
              break;
          }

          showMessage(message, 'error');
        } finally {
          setLoading(button, false);
        }
      };

      // Phone Login
      window.handlePhoneLogin = async function (event) {
        event.preventDefault();
        const form = event.target;
        const button = form.querySelector('button[type="submit"]');
        const phone = document.getElementById('phone').value;
        const phoneCode = document.getElementById('phoneCode').value;
        const phoneCodeGroup = document.getElementById('phoneCodeGroup');

        setLoading(button, true);
        clearMessages();

        try {
          if (!phoneConfirmationResult) {
            // First step: Send verification code
            if (!phoneVerifier) {
              phoneVerifier = new RecaptchaVerifier(auth, 'phoneForm', {
                'size': 'invisible'
              });
            }

            phoneConfirmationResult = await signInWithPhoneNumber(auth, phone, phoneVerifier);
            phoneCodeGroup.classList.remove('hidden');
            button.querySelector('.btn-text').textContent = 'Verify Code';
            showMessage('Verification code sent! Please check your phone.', 'success');
          } else {
            // Second step: Verify code
            await phoneConfirmationResult.confirm(phoneCode);
            showMessage('Successfully signed in!', 'success');

            // Reset form
            phoneCodeGroup.classList.add('hidden');
            button.querySelector('.btn-text').textContent = 'Send Code';
            phoneConfirmationResult = null;
            document.getElementById('phoneCode').value = '';
          }
        } catch (error) {
          console.error('Phone login error:', error);
          let message = 'Phone authentication failed.';

          switch (error.code) {
            case 'auth/invalid-phone-number':
              message = 'Please enter a valid phone number.';
              break;
            case 'auth/invalid-verification-code':
              message = 'Invalid verification code. Please try again.';
              break;
            case 'auth/code-expired':
              message = 'Verification code has expired. Please request a new one.';
              phoneConfirmationResult = null;
              phoneCodeGroup.classList.add('hidden');
              button.querySelector('.btn-text').textContent = 'Send Code';
              break;
          }

          showMessage(message, 'error');
        } finally {
          setLoading(button, false);
        }
      };

      // Google Login
      window.handleGoogleLogin = async function (event) {
        const button = event.target;
        setLoading(button, true);
        clearMessages();

        try {
          const result = await signInWithPopup(auth, provider);
          console.log('Google login successful:', result.user);
          showMessage('Successfully signed in with Google!', 'success');
        } catch (error) {
          console.error('Google login error:', error);
          let message = 'Google login failed.';

          switch (error.code) {
            case 'auth/popup-closed-by-user':
              message = 'Login was cancelled.';
              break;
            case 'auth/popup-blocked':
              message = 'Login popup was blocked. Please allow popups for this site.';
              break;
            case 'auth/unauthorized-domain':
              message = 'This domain is not authorized for Google login.';
              break;
          }

          showMessage(message, 'error');
        } finally {
          setLoading(button, false);
        }
      };

      // Logout
      window.handleLogout = async function () {
        console.log('Logout function called');
        const button = event.target;
        const originalText = button.textContent;
        
        // Simple loading state for logout button
        button.textContent = 'Signing out...';
        button.disabled = true;

        try {
          console.log('Starting logout process...');
          console.log('apiClient:', apiClient);
          
          // First, call server-side logout to revoke tokens
          if (apiClient && typeof apiClient.logout === 'function') {
            await apiClient.logout();
            console.log('Server logout successful');
          } else {
            console.warn('apiClient.logout not available, skipping server logout');
          }
          
          // Then, sign out from Firebase Auth
          await signOut(auth);
          console.log('Logout successful');
          showMessage('Successfully signed out!', 'success');
        } catch (error) {
          console.error('Logout error:', error);
          // Still try to sign out from Firebase Auth even if server logout fails
          try {
            await signOut(auth);
          } catch (signOutError) {
            console.error('Firebase sign out error:', signOutError);
          }
          showMessage('Logout failed: ' + error.message, 'error');
        } finally {
          // Restore button state
          button.textContent = originalText;
          button.disabled = false;
        }
      };

      // Auth state observer
      onAuthStateChanged(auth, async (user) => {
        if (user) {
          // User is signed in - hide auth section and show API testing
          document.getElementById('authSection').classList.add('hidden');
          const apiSection = document.getElementById('apiTestingSection');
          apiSection.classList.remove('hidden');
          // Add a small delay for smooth animation
          setTimeout(() => {
            apiSection.classList.add('visible');
          }, 100);

          // Update sidebar
          document.getElementById('apiNavSection').style.display = 'block';
          document.getElementById('userProfile').style.display = 'block';
          document.getElementById('sidebarUserEmail').textContent = user.email;

          // Update auth status
          if (document.getElementById('authStatus')) {
            document.getElementById('authStatus').innerHTML = `
              <p><strong>Authenticated as:</strong> ${user.email}</p>
              <p>Click "Get Fresh ID Token" to test authenticated endpoints</p>
              <button class="btn btn-primary" onclick="getFreshToken()">Get Fresh ID Token</button>
            `;
          }

          // Create session cookie from JWT token
          try {
            const token = await user.getIdToken();
            await apiClient.createSession(token);
            console.log('Session cookie created successfully');
          } catch (error) {
            console.error('Error creating session cookie:', error);
            // Fallback to localStorage if session cookie creation fails
            try {
              const token = await user.getIdToken();
              localStorage.setItem('authToken', token);
              console.log('JWT token stored in localStorage as fallback');
            } catch (fallbackError) {
              console.error('Error setting up authentication fallback:', fallbackError);
            }
          }
        } else {
          // User is signed out - show auth section and hide API testing
          document.getElementById('authSection').classList.remove('hidden');
          
          // Hide API testing section
          document.getElementById('apiTestingSection').classList.remove('visible');
          document.getElementById('apiTestingSection').classList.add('hidden');
          
          // Update sidebar
          document.getElementById('apiNavSection').style.display = 'none';
          document.getElementById('userProfile').style.display = 'none';
          
          // Update auth status
          if (document.getElementById('authStatus')) {
            document.getElementById('authStatus').innerHTML = `
              <p>Not authenticated</p>
              <button id="getTokenBtn" class="btn btn-primary" onclick="getFreshToken()">Get Fresh ID Token</button>
            `;
          }
          window.currentIdToken = null;
          
          localStorage.removeItem('authToken');
          apiClient.clearSession();
          console.log('User signed out, tokens and cookies cleared');

          // Reset phone form
          document.getElementById('phoneCodeGroup').classList.add('hidden');
          document.getElementById('phoneCode').value = '';
          phoneConfirmationResult = null;
          phoneVerifier = null;
        }
      });

      // API Testing Functions
      window.getFreshToken = async function() {
        const user = auth.currentUser;
        if (!user) {
          showMessage('Please sign in first', 'error');
          return;
        }

        try {
          const token = await user.getIdToken(true); // Force refresh
          const tokenPreview = token.substring(0, 50) + '...';
          
          document.getElementById('authStatus').innerHTML = `
            <p><strong>Authenticated as:</strong> ${user.email}</p>
            <p><strong>ID Token:</strong> <code>${tokenPreview}</code></p>
            <button class="btn btn-success" onclick="copyToken()">Copy Token</button>
            <button class="btn btn-secondary" onclick="clearAuth()">Clear</button>
          `;
          
          // Store token for testing
          window.currentIdToken = token;
          showMessage('Fresh ID token obtained successfully!', 'success');
        } catch (error) {
          console.error('Error getting fresh token:', error);
          showMessage('Failed to get fresh token: ' + error.message, 'error');
        }
      };

      window.copyToken = function() {
        if (window.currentIdToken) {
          navigator.clipboard.writeText(window.currentIdToken);
          showMessage('Token copied to clipboard!', 'success');
        }
      };

      window.clearAuth = function() {
        window.currentIdToken = null;
        document.getElementById('authStatus').innerHTML = `
          <p>Not authenticated</p>
          <button id="getTokenBtn" class="btn btn-primary" onclick="getFreshToken()">Get Fresh ID Token</button>
        `;
        showMessage('Authentication cleared', 'info');
      };

      window.testEndpoint = async function(endpointType, requiresAuth) {
        if (requiresAuth && !window.currentIdToken) {
          showMessage('Please get a fresh ID token first', 'error');
          return;
        }

        // Set button loading state
        const button = event.target;
        setButtonLoading(button, true);

        // Get the result container for this endpoint
        const resultContainer = document.getElementById(`${endpointType}-result`);
        if (resultContainer) {
          resultContainer.classList.remove('hidden');
          resultContainer.querySelector('.result-content').innerHTML = 'Testing endpoint...';
        }

        let url, method, body;
        // Detect current environment and use appropriate base URL
        const isDevelopment = window.location.hostname === 'localhost' || 
                             window.location.hostname === '127.0.0.1' || 
                             window.location.hostname === 'metrics.dev-chrisvogt.me';
        
        const baseUrl = isDevelopment ? '' : 'https://metrics.chrisvogt.me';

        switch (endpointType) {
          case 'widgets':
            const widgetProvider = document.getElementById('widgetProvider').value;
            url = `${baseUrl}/api/widgets/${widgetProvider}`;
            method = 'GET';
            break;
          
          case 'session':
            url = `${baseUrl}/api/auth/session`;
            method = 'POST';
            body = JSON.stringify({});
            break;
          
          case 'sync':
            const syncProvider = document.getElementById('syncProvider').value;
            url = `${baseUrl}/api/widgets/sync/${syncProvider}`;
            method = 'GET';
            break;
          
          default:
            showMessage('Unknown endpoint type', 'error');
            setButtonLoading(button, false);
            return;
        }

        const headers = {
          'Content-Type': 'application/json'
        };

        if (requiresAuth) {
          headers['Authorization'] = `Bearer ${window.currentIdToken}`;
        }

        const options = {
          method,
          headers,
          credentials: 'include'
        };

        if (body) {
          options.body = body;
        }

        try {
          const startTime = Date.now();
          const response = await fetch(url, options);
          const endTime = Date.now();
          const responseTime = endTime - startTime;

          let responseData;
          try {
            responseData = await response.json();
          } catch {
            responseData = await response.text();
          }

          const result = {
            endpoint: endpointType,
            url,
            method,
            status: response.status,
            statusText: response.statusText,
            responseTime: `${responseTime}ms`,
            headers: Object.fromEntries(response.headers.entries()),
            data: responseData
          };

          // Update inline result
          updateInlineResult(endpointType, result, response.ok);
        } catch (error) {
          const result = {
            endpoint: endpointType,
            url,
            method,
            error: error.message,
            timestamp: new Date().toISOString()
          };
          
          // Update inline result with error
          updateInlineResult(endpointType, result, false);
        } finally {
          // Reset button loading state
          setButtonLoading(button, false);
        }
      };

      // Button loading state management
      function setButtonLoading(button, loading) {
        const btnText = button.querySelector('.btn-text');
        const btnLoading = button.querySelector('.btn-loading');

        console.log('Setting button loading state:', loading, button);

        if (loading) {
          btnText.classList.add('hidden');
          btnLoading.classList.remove('hidden');
          button.classList.add('loading');
          button.disabled = true;
          console.log('Button set to loading state');
        } else {
          btnText.classList.remove('hidden');
          btnLoading.classList.add('hidden');
          button.classList.remove('loading');
          button.disabled = false;
          console.log('Button set to normal state');
        }
      }

      // Update inline result for endpoints
      function updateInlineResult(endpointType, result, success) {
        const resultContainer = document.getElementById(`${endpointType}-result`);
        if (!resultContainer) return;

        const statusElement = resultContainer.querySelector('.result-status');
        const timeElement = resultContainer.querySelector('.result-time');
        const contentElement = resultContainer.querySelector('.result-content');

        // Update status
        if (success) {
          statusElement.textContent = `✅ ${result.status} ${result.statusText}`;
          statusElement.className = 'result-status success';
        } else {
          statusElement.textContent = `❌ ${result.error || `${result.status} ${result.statusText}`}`;
          statusElement.className = 'result-status error';
        }

        // Update time
        if (result.responseTime) {
          timeElement.textContent = result.responseTime;
        } else {
          timeElement.textContent = new Date().toLocaleTimeString();
        }

        // Update content
        let content = '';
        if (success) {
          content += `URL: ${result.url}\n`;
          content += `Method: ${result.method}\n`;
          content += `Status: ${result.status} ${result.statusText}\n`;
          content += `Response Time: ${result.responseTime}\n\n`;
          content += 'Response Data:\n';
          content += JSON.stringify(result.data, null, 2);
        } else {
          content += `URL: ${result.url}\n`;
          content += `Method: ${result.method}\n`;
          if (result.error) {
            content += `Error: ${result.error}\n`;
          } else {
            content += `Status: ${result.status} ${result.statusText}\n`;
          }
          content += `Timestamp: ${result.timestamp}\n`;
        }

        contentElement.textContent = content;
      }

      // Skeleton placeholder management





    } // Close initializeApp function

          // Reset all button states on page load
      function resetAllButtonStates() {
        const buttons = document.querySelectorAll('[data-endpoint]');
        buttons.forEach(button => {
          const btnText = button.querySelector('.btn-text');
          const btnLoading = button.querySelector('.btn-loading');
          
          if (btnText && btnLoading) {
            btnText.classList.remove('hidden');
            btnLoading.classList.add('hidden');
            button.classList.remove('loading');
            button.disabled = false;
          }
        });
      }

      // Dashboard Functions
      window.toggleSidebar = function() {
        const sidebar = document.getElementById('dashboardSidebar');
        sidebar.classList.toggle('mobile-open');
      };

      // Navigation handling
      document.addEventListener('click', function(e) {
        if (e.target.closest('.nav-item')) {
          const navItem = e.target.closest('.nav-item');
          const section = navItem.dataset.section;
          
          // Update active nav item
          document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
          navItem.classList.add('active');
          
          // Handle section navigation
          if (section === 'auth') {
            document.getElementById('authSection').classList.remove('hidden');
            document.getElementById('apiTestingSection').classList.add('hidden');
            
            // Scroll to top of page for authentication section
            window.scrollTo({
              top: 0,
              behavior: 'smooth'
            });
          } else if (section === 'widget-data' || section === 'sync-data') {
            // Show API testing section
            document.getElementById('authSection').classList.add('hidden');
            document.getElementById('apiTestingSection').classList.remove('hidden');
            
            // Scroll to specific section within API testing
            setTimeout(() => {
              const targetSection = document.getElementById(section);
              if (targetSection) {
                // Calculate scroll position to show the section with some space above
                const headerHeight = 80; // Approximate header height
                const offset = 40; // Additional space above the section
                const targetPosition = targetSection.offsetTop - headerHeight - offset;
                
                // Smooth scroll to the calculated position
                window.scrollTo({
                  top: targetPosition,
                  behavior: 'smooth'
                });
                
                // Add highlight effect
                targetSection.style.animation = 'none';
                targetSection.offsetHeight; // Trigger reflow
                targetSection.style.animation = 'highlightSection 0.5s ease-out';
              }
            }, 100);
          }
        }
      });

      // Start the app
      initializeFirebase();
      
      // Reset button states when DOM is ready
      document.addEventListener('DOMContentLoaded', resetAllButtonStates);
      
      // Also reset immediately if DOM is already loaded
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', resetAllButtonStates);
      } else {
        resetAllButtonStates();
      }
  </script>
</body>

</html>